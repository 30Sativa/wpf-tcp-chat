<Window x:Class="ChatClient.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="TCP Chat Client"
        Height="600"
        Width="900"
        WindowStartupLocation="CenterScreen"
        Background="#ECEFF1">

    <!-- ================= RESOURCES ================= -->
    <Window.Resources>
        <!-- Modern Button Style -->
        <Style x:Key="ModernButton" TargetType="Button">
            <Setter Property="Background" Value="#2196F3"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="4"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" 
                                            VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#1976D2"/>
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Background" Value="#BDBDBD"/>
                    <Setter Property="Cursor" Value="Arrow"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Send Button Style -->
        <Style x:Key="SendButton" TargetType="Button" BasedOn="{StaticResource ModernButton}">
            <Setter Property="Background" Value="#4CAF50"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#388E3C"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Emoji Button Style -->
        <Style x:Key="EmojiButton" TargetType="Button">
            <Setter Property="Background" Value="#FF9800"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Width" Value="45"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="4">
                            <ContentPresenter HorizontalAlignment="Center" 
                                            VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#F57C00"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Small Emoji Button -->
        <Style x:Key="SmallEmojiButton" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontSize" Value="24"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Width" Value="45"/>
            <Setter Property="Height" Value="45"/>
            <Setter Property="Margin" Value="3"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#F5F5F5"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Modern TextBox Style -->
        <Style x:Key="ModernTextBox" TargetType="TextBox">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4">
                            <ScrollViewer x:Name="PART_ContentHost"
                                        Padding="{TemplateBinding Padding}"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <!-- ================= LAYOUT ================= -->
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- ================= HEADER ================= -->
        <Border Grid.Row="0" Background="#2196F3" Padding="20,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Left Side -->
                <StackPanel Grid.Column="0" VerticalAlignment="Center">
                    <TextBlock Text="Chat Application"
                               FontSize="20"
                               FontWeight="Bold"
                               Foreground="White"/>
                    <TextBlock x:Name="txtStatus"
                               Text="Not Connected"
                               Foreground="#E3F2FD"
                               FontSize="12"
                               Margin="0,3,0,0"/>
                </StackPanel>

                <!-- Right Side -->
                <StackPanel Grid.Column="1"
                            Orientation="Horizontal"
                            VerticalAlignment="Center">

                    <TextBox x:Name="txtName"
                             Style="{StaticResource ModernTextBox}"
                             Width="100"
                             Margin="0,0,10,0"
                             Text="User"/>

                    <TextBox x:Name="txtServerIP"
                             Style="{StaticResource ModernTextBox}"
                             Width="120"
                             Margin="0,0,10,0"
                             Text="127.0.0.1"/>

                    <TextBox x:Name="txtPort"
                             Style="{StaticResource ModernTextBox}"
                             Width="70"
                             Margin="0,0,10,0"
                             Text="5000"/>

                    <Button Content="Connect"
                            Style="{StaticResource ModernButton}"
                            MinWidth="100"
                            Click="Connect_Click"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ================= CHAT MESSAGES ================= -->
        <Border Grid.Row="1"
                Margin="20,20,20,0"
                Background="White"
                BorderBrush="#E0E0E0"
                BorderThickness="1"
                CornerRadius="6">
            <Border.Effect>
                <DropShadowEffect Color="#000000" 
                                Opacity="0.08" 
                                ShadowDepth="2" 
                                BlurRadius="10"/>
            </Border.Effect>

            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Chat Header -->
                <Border Grid.Row="0"
                        Background="#F5F5F5"
                        BorderBrush="#E0E0E0"
                        BorderThickness="0,0,0,1"
                        Padding="15,12">
                    <TextBlock Text="Messages"
                             FontSize="14"
                             FontWeight="SemiBold"
                             Foreground="#424242"/>
                </Border>

                <!-- Messages Area -->
                <ScrollViewer Grid.Row="1"
                            VerticalScrollBarVisibility="Auto"
                            Background="#FAFAFA">
                    <TextBox x:Name="txtMessages"
                             Padding="15"
                             IsReadOnly="True"
                             TextWrapping="Wrap"
                             BorderThickness="0"
                             Background="Transparent"
                             FontFamily="Segoe UI"
                             FontSize="13"/>
                </ScrollViewer>
            </Grid>
        </Border>

        <!-- ================= INPUT AREA ================= -->
        <Border Grid.Row="2"
                Margin="20"
                Background="White"
                BorderBrush="#E0E0E0"
                BorderThickness="1"
                CornerRadius="6"
                Padding="15">
            <Border.Effect>
                <DropShadowEffect Color="#000000" 
                                Opacity="0.08" 
                                ShadowDepth="2" 
                                BlurRadius="10"/>
            </Border.Effect>

            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Message Input -->
                <TextBox x:Name="txtMessage"
                         Grid.Column="0"
                         Style="{StaticResource ModernTextBox}"
                         Height="40"
                         KeyDown="TxtMessage_KeyDown"/>

                <!-- Emoji Button with Popup -->
                <Grid Grid.Column="1" Margin="10,0">
                    <Button x:Name="btnEmoji"
                            Content="▲"
                            Style="{StaticResource EmojiButton}"
                            Click="ToggleEmojiPanel"/>

                    <!-- Emoji Popup -->
                    <Popup x:Name="EmojiPopup"
                           PlacementTarget="{Binding ElementName=btnEmoji}"
                           Placement="Top"
                           StaysOpen="False"
                           AllowsTransparency="True">
                        <Border Background="White"
                                BorderBrush="#BDBDBD"
                                BorderThickness="1"
                                CornerRadius="8"
                                Padding="10">
                            <Border.Effect>
                                <DropShadowEffect Color="#000000" 
                                                Opacity="0.15" 
                                                ShadowDepth="3" 
                                                BlurRadius="12"/>
                            </Border.Effect>

                            <StackPanel>
                                <TextBlock Text="Pick an Emoji"
                                         FontSize="12"
                                         FontWeight="SemiBold"
                                         Foreground="#757575"
                                         Margin="5,0,0,8"/>

                                <WrapPanel Width="220">
                                    <Button Content="😊" Tag="😊" Style="{StaticResource SmallEmojiButton}" Click="Emoji_Click"/>
                                    <Button Content="😂" Tag="😂" Style="{StaticResource SmallEmojiButton}" Click="Emoji_Click"/>
                                    <Button Content="😍" Tag="😍" Style="{StaticResource SmallEmojiButton}" Click="Emoji_Click"/>
                                    <Button Content="🥰" Tag="🥰" Style="{StaticResource SmallEmojiButton}" Click="Emoji_Click"/>
                                    <Button Content="😎" Tag="😎" Style="{StaticResource SmallEmojiButton}" Click="Emoji_Click"/>
                                    <Button Content="🤔" Tag="🤔" Style="{StaticResource SmallEmojiButton}" Click="Emoji_Click"/>
                                    <Button Content="😢" Tag="😢" Style="{StaticResource SmallEmojiButton}" Click="Emoji_Click"/>
                                    <Button Content="😭" Tag="😭" Style="{StaticResource SmallEmojiButton}" Click="Emoji_Click"/>
                                    <Button Content="😡" Tag="😡" Style="{StaticResource SmallEmojiButton}" Click="Emoji_Click"/>
                                    <Button Content="🤯" Tag="🤯" Style="{StaticResource SmallEmojiButton}" Click="Emoji_Click"/>
                                    <Button Content="👍" Tag="👍" Style="{StaticResource SmallEmojiButton}" Click="Emoji_Click"/>
                                    <Button Content="👎" Tag="👎" Style="{StaticResource SmallEmojiButton}" Click="Emoji_Click"/>
                                    <Button Content="❤️" Tag="❤️" Style="{StaticResource SmallEmojiButton}" Click="Emoji_Click"/>
                                    <Button Content="💯" Tag="💯" Style="{StaticResource SmallEmojiButton}" Click="Emoji_Click"/>
                                    <Button Content="🔥" Tag="🔥" Style="{StaticResource SmallEmojiButton}" Click="Emoji_Click"/>
                                    <Button Content="✨" Tag="✨" Style="{StaticResource SmallEmojiButton}" Click="Emoji_Click"/>
                                </WrapPanel>
                            </StackPanel>
                        </Border>
                    </Popup>
                </Grid>

                <!-- Send Button -->
                <Button x:Name="btnSend"
                        Grid.Column="2"
                        Content="Send Message"
                        Style="{StaticResource SendButton}"
                        Height="40"
                        MinWidth="130"
                        IsEnabled="False"
                        Click="Send_Click"/>
            </Grid>
        </Border>
    </Grid>
</Window>
